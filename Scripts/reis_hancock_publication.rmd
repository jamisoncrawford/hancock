---
title: 'Hancock: Importing Whites, Exporting Wealth'
author: "Jamison R. Crawford, MPA"
date: "November 10, 2018"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 4
    number_sections: true
---

```{r load_all, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}

if(!require(sf)){install.packages("sf")}
if(!require(tmap)){install.packages("tmap")}
if(!require(readr)){install.packages("readr")}
if(!require(dplyr)){install.packages("dplyr")}
if(!require(GGally)){install.packages("GGally")}
if(!require(tigris)){install.packages("tigris")}
if(!require(scales)){install.packages("scales")}
if(!require(stringr)){install.packages("stringr")}
if(!require(ggplot2)){install.packages("ggplot2")}
if(!require(leaflet)){install.packages("leaflet")}
if(!require(viridis)){install.packages("viridis")}
if(!require(geosphere)){install.packages("geosphere")}
if(!require(noncensus)){install.packages("noncensus")}
if(!require(flextable)){install.packages("flextable")}

library(sf)
library(tmap)
library(readr)
library(dplyr)
library(GGally)
library(tigris)
library(scales)
library(stringr)
library(ggplot2)
library(leaflet)
library(viridis)
library(geosphere)
library(noncensus)
library(flextable)

rm(list = ls())

url <- "https://raw.githubusercontent.com/jamisoncrawford/REIS/master/Tables/hancock_master_table_1.4.csv"
master <- read_csv(file = url, col_types = "cccccccnnDccccnnccliii"); rm(url)
```

# Warning

**The present work is considered a "sneak peek" for testing purposes** and early sharing with collaborators. The data used and findings herein are not considered final for public consumption by the principal analyst.

**Update****:** The following tables and visualizations have been reviewed and the author is relatively confident in their accuracy. However, the accompanying written interpretations have yet to be reviewed and *are not accurate*. 

<br>

# Executive Summary

TBD.

<br>

# Introduction

**Glass and aluminum** curtain walls, a grand staicase, and an indoor waterfall, among other features, now adorn the Syracuse Hancock International Airport, and will greet over two million travelers and other passersby for years to come. The terminal, built in 1961, underwent significant renovations throughout much of 2018, slated for completion in late Fall, at the cost of $60 million: $35.8 million from New York State, $1 million from Onondaga County, and the remainder from both federal and local sources ([Moriarty, 2018](https://www.syracuse.com/news/index.ssf/2018/07/first_look_inside_syracuse_airport_terminal_renovations_photos.html)).
 
**The true cost to Syracuse** is one of opportunity. That is, opportunity costs in providing work to Syracuse residents, particularly African American and Latino residents, by failing to employ a workforce that remotely approximates the ethnoracial makeup of the city. Moreover, the mass exportation of wealth to tradesmen outside of Onondaga County proves further opportunity costs, as the vast majority of disposable income is distributed throughout New York State and northern Pennsylvania.

<br>

<center>

```{r concept_art, echo=FALSE, fig.cap="*Concept rendering for the passenger terminal at Hancock International Airport. Source: [Syracuse.com](https://www.syracuse.com/business-news/index.ssf/2017/10/heres_what_syracuse_airport_will_look_like_after_49m_renovation_photos.html)*", out.width = '90%'}

knitr::include_graphics("https://image.syracuse.com/home/syr-media/width960/img/post-standard/photo/2017/10/17/-f16fcc8e20f3ee69.JPG")

```

</center>

<br>

## Background

**The motivation and impetus** behind this publication stems from the combined efforts of the [Urban Jobs Task Force (UJTF)](http://www.ujtf.org/) and [Legal Services of Western New York (LSCNY)](https://www.lscny.org/), a collaboration endeavoring to scrutinize myriad construction projects in the Greater Syracuse area, the final results of which are to be published in their *Racial Equity Impact Statement*, or REIS, which both describes the racial disparities in construction-related employment practices, as well as provides recommendations for ameliorating said disparities. Most importantly, the intent of the REIS is to ensure more equitable employment practices in the highly publicized and much anticipated renovation of [Interstate 86](https://en.wikipedia.org/wiki/Interstate_86_(Pennsylvania%E2%80%93New_York)).
 
**Seeking assistance in wrangling and analyzing** raw employment records retrieved by leveraging the [Freedom of Information Act (FOIA)](https://www.foia.state.gov/Learn/FOIA.aspx), LSCNY recruited volunteers from the biweekly *Community Data Meet-Up*, a collaborative collection of largely social sector analysts, grantwriters, executives, and other data professionals sponsored by the [Central New York Community Foundation (CNYCF)](https://cnycf.org/). 
 
<br>
 
## Initial & New Hypotheses

**The initial hypothesis warranting creation of the REIS** was the existence of racial disparities in construction-related employment practices, demonstrated by LSCNY and UJTF's poring over employment records for recent renovations of a local portion of [Interstate 690](https://en.wikipedia.org/wiki/Interstate_690) and depicting an ethnoracial makeup markedly at odds with Syracuse demographics.
 
**Analyzing the Hancock renovation data revealed unanticipated insight** into the geographic representation of construction employees, where location data were available, expanding the scope of analysis to include from where, precisely, workers were imported. Not only were the vast majority of workers White males, they traveled from all over New York State, as well as northern counties in Pennsylvania. With wage data at hand, analysts discovered a mass exodus and dissemination of capital from Syracuse, only a fraction of which was received by residents living in Onondaga County.
 
<br>
 
## Methods

**Employment records were compiled** from [photocopies stored as PDFs](https://github.com/jamisoncrawford/REIS/tree/master/Raw%20Data) and extracted using both manual scraping and automated scraping with optical character recognition in R, an Open Source, scripted computer language designed for statistical analysis and other data science tasks. Variables of interest, if available, initially included workers':
 
* Last four digits of social security numbers
* Zip codes or other location data
* Status, titles, and vocations
* Race and gender
* Unions

**As the scope of analysis grew,** variables of interest were expanded to include workers':

* Weekly net payments, i.e. gross income less deductions
* Hourly wages when race or gender available
* Ending date of working period

**Once scraped, the data were merged** into a master table in [tidy format](https://vita.had.co.nz/papers/tidy-data.pdf). Additional variable definitions, units of measurement, raw data, scraping and processing scripts, and final tables are available in the [REIS GitHub repository](https://github.com/jamisoncrawford/REIS).

**Zipcodes were used to determine other location data** by merging the master table with the R `zipcodes` library, providing the city, state, and longitude/latitude coordinates, while [Federal Information Processing Standard (FIPS) codes](https://en.wikipedia.org/wiki/FIPS_county_code) were included to identify the state FIPS ID, county FIPS ID, and county name using the R `noncensus` library. The master table may be found in the ["Tables" folder of the REIS GitHub repository](https://github.com/jamisoncrawford/REIS/blob/master/Tables/hancock_master_table_1.2.csv). The code book, including variable definitions, units of measurement, and variable transformation details, is available in the [REIS Code Book](https://github.com/jamisoncrawford/REIS/blob/master/codebook.md), while a more in-depth overview ofmethodology and preprocessing steps is available in the [REIS README](https://github.com/jamisoncrawford/REIS/blob/master/README.md). 

<br>

## Sources: Companies Reviewed

**Records retrieved from the FOIA request** for Hancock construction included the following companies:

* John W. Danforth Company
* Edward Schalk & Son, Inc.
* Longhouse Construction LLC
* Niagara Erecting, Inc.
* NRC NY Environmental Services, Inc.
* Patricia Electric, Inc.
* Quality Structures, Inc.
* Stone Bridge Iron & Steel, Inc.

**There are some notable caveats.** Though provided, *M&S Fire Protection LLC* contained no variables of interest. While it contained some important data, *Niagara Erecting, Inc.* appeared to have handwritten weekly deductions and net pay, which were entirely illegible even in manual scraping. Though it provided gross amount earned, no attempt to extrapolate net pay was made. Lastly, not all records provided race or gender and in records for most companies reviewed, some data were obfuscated or redacted sporadically. Therefore, analysis was performed having filtered or imputed missing data where appropriate. A full list of target variables by company, as well as additional metadata, is available in the ["Target Variables" page of the REIS GitHub repository](https://github.com/jamisoncrawford/REIS/blob/master/target_variables.md).

<br>

# Findings: On Race

**The following outlines significant findings** in racial disparities in employment for Hancock Airport construction contractors which provided demographic information in the FOIA request. Where relevant, additional notable findings discovered in exploratory analysis are also provided. Lastly, net wage and location data are organized and visualized similarly, with accompanying interpretations provided.

**Notably, 100% of employees were male,** according to demographic records provided. Therefore, gender disparities are neither possible to determine, aproximate, nor impute.

<br>

## On Demographic Data

```{r data_overview, echo=FALSE, message=FALSE}
library(scales)
library(dplyr)

x <- nrow(master %>% filter(!is.na(race)))
y <- nrow(master %>% filter( is.na(race)))
p <- percent(y / x + y)
```

**As an important caveat, contractors failing to disclose race or gender** in their employment records comprise `r p` of total payments throughout construction. That is, out of a total `r format(x + y, big.mark = ",")` recorded weekly payments, `r y` did not contain any race or gender data, while `r x` did. It is impossible to impute or otherwise approximate these data. Contractors failing to disclose race include:

* John W. Danforth Company
* Niagara Erecting, Inc.
* NRC NY Environmental Services, Inc.

```{r individuals_overview, echo=FALSE, message=FALSE}
library(dplyr)
library(scales)

x <- master %>% filter(!is.na(race)) %>% select(name:rate, zip) %>% unique() %>% nrow()
y <- master %>% filter( is.na(race)) %>% select(name:rate, zip) %>% unique() %>% nrow()
p <- percent(x / (x + y))
p_na <- percent(y / (x + y))
```

**In terms of individual employees, rather than records,** the number of unique workers are determined by using each unique combination of social security numbers (or unique identification codes if unavailable), zip codes, and company names. In total, there are `r x + y` unique workers, `r x`, or `r p` of whom have race disclosed, while `r y`, or `r p_na` do not. 

<br>

## Workers by Race

**Of the nine contractors producing employment records,** only five maintained records with workers' ethnoracial data:

* Edward Schalk & Son, Inc.
* Longhouse Construction LLC
* Patricia Electric, Inc.
* Quality Structures, Inc.
* Stone Bridge Iron & Steel, Inc.

```{r ind_race_overview, message=FALSE, echo=FALSE}
library(dplyr)

individuals <- master %>% 
  filter(!is.na(race)) %>% 
  select(name:rate, zip) %>% 
  unique()

wh <- individuals[individuals$race == "White", ]
aa <- individuals[individuals$race == "African American", ]
na <- individuals[individuals$race == "Native American", ]
mr <- individuals[individuals$race == "Two or More Races", ]
hs <- individuals[individuals$race == "Hispanic", ]
```

**The race of each unique worker is identified** by determining all unique combinations of company names, social security numbers, race, and zip code, revealing `r nrow(individuals)` unique individuals for whom race is disclosed. *Table 1: Unique Workers by Race* depicts `r nrow(wh)` unique White workers, comprising the lion's share of total workers (`r percent(nrow(wh) / nrow(individuals))`), while only `r nrow(aa)` African American workers (`r percent(nrow(na) / nrow(individuals))`), `r nrow(na)` Native American workers (`r percent(nrow(aa) / nrow(individuals))`), and `r nrow(mr)` workers of two or more races (`r percent(nrow(mr) / nrow(individuals))`). Notably, only a single worker was identified as Hispanic or Latino (`r percent(nrow(hs) / nrow(individuals))`). These disparities are illustrated in *Figure 1: Unique Workers v. Race*.

<center>

**Table 1: Unique Workers by Race**
 
```{r race_count_table, message=FALSE, echo=FALSE}
library(flextable)
library(scales)

ind_table <- as_data_frame(table(individuals$race)) %>% 
  rename("Race" = Var1, "Unique Workers" = n) %>% 
  mutate(Percentage = percent(`Unique Workers` / sum(`Unique Workers`))) %>%
  arrange(desc(`Unique Workers`))

ind_table_ft <- regulartable(ind_table, cwidth = 3.5)
ind_table_ft <- fontsize(ind_table_ft, part = "all", size = 14)
theme_box(ind_table_ft)
```

<br>

**Figure 1: Unique Workers v. Race**

```{r race_count_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=7}
library(ggplot2)

ggplot(ind_table, aes(x = reorder(Race, `Unique Workers`), 
                      y = `Unique Workers`)) +
  geom_bar(stat = "identity", alpha = 0.6, fill = "tomato") +
  coord_flip() +
  xlab("Race") +
  ylab("Unique Workers") +
  theme_light()
```

</center>

<br>

## Workers by Race & Contractor

**Further breaking down unique worker race by contractors reveals additional findings** about workforce diversity, or lack thereof, within the companies themselves. For example, *Table 2: Unique Workers by Race & Contractor* reveals that all 9 workers in *Patricia Electric, Inc.* are White, while *Edward Schalk & Son, Inc.*, had more than twice the unique workers, 21 of whom were White (91.3%) and the remaining 2 of whom were African American (8.7%). *Longhouse Construction LLC* had a similar proportion of White to African American workers, with 1 of 7 unique workers identified as African American (14.3%) and the remaining 6 workers identified as White (85.7%). 

**Notably, the lowest proportion of unique White workers** (69.2%) were hired by *Stone Bridge Iron & Steel, Inc.*, which also accounts for the majority of unique Native American workers among *all companies* (75%), with 3 of all 4 Native Americans identified within the company (23.1%). *Quality Structures, Inc.* had the greatest diversity in terms of distinct races. To wit, White, African American, Two or More Races, and Native American workers were among its ranks, though the vast majority were White (88.9%). *Figure 2: Unique Workers v. Race by Contractor* illustrates these proportions among each contractor.

<br>

<center>

**Table 2: Unique Workers by Race & Contractor**

```{r contractor_race_table, echo=FALSE, message=FALSE}
library(flextable)
library(scales)

con_table <- individuals %>%
  group_by(name, race) %>%
  summarize(unique = n()) %>%
  rename("Contractor" = name, 
         "Race" = race, 
         "Unique Workers" = unique) %>%
  mutate(Percentage = percent(`Unique Workers` / sum(`Unique Workers`))) %>%
  arrange(Contractor, desc(`Unique Workers`))

con_table_ft <- regulartable(con_table, cwidth = 3.5)
con_table_ft <- fontsize(con_table_ft, part = "all", size = 14)
theme_box(con_table_ft)
```

<br>

**Figure 2: Unique Workers v. Race by Contractor**

```{r contractor_race_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=7}
library(ggplot2)
library(Cairo)

ggplot(con_table, aes(x = reorder(Contractor, `Unique Workers`), 
                      y = `Unique Workers`, 
                      fill = Race)) +
  geom_bar(stat = "identity", alpha = 0.6) +
  coord_flip() +
  xlab("Contractor") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  theme(legend.position = "bottom")
```

</center>

<br>

## Periods by Race

```{r periods_by_race, echo=FALSE, message=FALSE}
library(dplyr)

week_table <- master %>% 
  filter(!is.na(race)) %>%
  group_by(name, race, zip, ssn) %>%
  summarize(periods = n()) %>%
  arrange(desc(periods))

week_table <- week_table[, c("race", "periods")]
week_table <- week_table %>%
  group_by(race) %>%
  summarize(Periods = sum(periods)) %>%
  rename("Race" = race) %>%
  mutate(`Periods (%)` = percent(Periods / sum(Periods))) %>%
  arrange(desc(Periods)) %>%
  bind_cols(ind_table) %>%
  select(Race:`Periods (%)`, Percentage) %>%
  rename("Workers (%)" = Percentage)
```

**Racial disparities in total weeks worked are slightly larger.** Among the `r sum(week_table$Periods)` recorded pay periods containing race data, with uniqueness determined by permutations of companies, zip codes, social security numbers, and race, White workers accounted for approximately 715 weekly paychecks (89.3%), slightly higher than the proportion of unique White workers (86.2%). *Table 3: Total Weeks Worked by Race* further illustrates a slightly smaller proportion of the 47 weekly paychecks received by African Americans (5.9%) compared to the proportion of African Americans among all unique workers (7.3%). Similar discrepancies exist among Native American and Hispanic workers' total work weeks. 

**In other words, White workers took home a slightly larger proportion of paychecks,** as well as comprised a significantly larger proportion of the total workforce compared to workers of color, while workers of color spent fewer weeks on the job compared to their proportion in the total workforce. Of particular note, again, is the single Hispanic worker among all 123 unique workers involved the renovations. Of the 801 paychecks distributed, he received 2. This is further illustrated in *Figure 3: Total Weeks Worked v. Race*. 

<br>

<center>

**Table 3: Total Weeks Worked by Race**

```{r periods_by_race_tbl, echo=FALSE, message=FALSE}
week_table_ft <- regulartable(week_table, cwidth = 3.5)
week_table_ft <- fontsize(week_table_ft, part = "all", size = 14)
theme_box(week_table_ft)
```

<br>

**Figure 3: Total Weeks Worked v. Race**

```{r periods_by_race_viz, echo=FALSE, message=FALSE}
ggplot(week_table, aes(x = reorder(Race, `Periods`), 
                      y = Periods)) +
  geom_bar(stat = "identity", alpha = 0.6, fill = "tomato") +
  coord_flip() +
  xlab("Race") +
  ylab("Periods (In Weeks)") +
  theme_light()
```

</center>

<br>

## Periods by Race & Contractor

```{r periods_race_con, echo=FALSE, message=FALSE}
library(dplyr)
library(scales)

week_con_table <- master %>%
  filter(!is.na(race)) %>%
  group_by(name, race, zip, ssn) %>%
  summarize(periods = n()) %>%
  arrange(desc(periods))
  
week_con_table <- week_con_table[, c("name", "race", "periods")]
week_con_table <- week_con_table %>%
  group_by(name, race) %>%
  summarize(Periods = sum(periods)) %>%
  rename("Race" = race, 
         "Contractor" = name) %>%
  mutate(`Periods (%)` = percent(Periods / sum(Periods))) %>%
  arrange(Contractor, desc(Periods)) %>% 
  bind_cols(con_table) %>%
  select(Contractor:`Periods (%)`, Percentage) %>%
  rename("Workers (%)" = Percentage)
```

**Breaking down total periods worked by race and contractor reveals additional, albeit slight disparities.** Note herein that "payment", "paycheck", "work week", and "work period" are used interchangeably and units of analysis represent a single work period for one unique worker. In other words, one unique worker may work multiple periods throughout the duration of construction and periods are measured cumulatively. *Table 4: Total Weeks Worked by Race & Contractor* depicts the total count and proportion of working periods by race among each contractor. *Quality Structures, Inc.* appears to have the greatest disparities, with Whites comprising 85.9% of workers but taking home 89.5% of the 607 paychecks distributed, while African Americans comprised 8.5% of workers and receiving 6.3% of all weekly paychecks. The 4.2% of workers in *Quality Structures, Inc.* took home a total of 15 paychecks (2.5%) while, unusually, the 3 Native Americans among its workers (1.4%) received payment for 1.8% of all work periods.

**Racial disparities in weeks worked are smaller among other contractors.** The 91.3% of White workers in *Edward Schalk & Son, Inc.* received 73 payments of 79 total weeks worked (92.4%) while the remaining 8.7% of paychecks were distributed to its African American workers, or 7.6% of all payment periods, indicating slightly more work time for Whites in proportion to the company's racial makeup. *Longhouse Construction LLC* exhibited similarly small disparities, with an 85.7% of Whites working 86.4% of its total work weeks and 14.3% of African Americans working only 13.6% of total work weeks. Notably, *Stone Bridge Iron & Steel, Inc.* was the only organization which reversed this trend, with 69.2% of Whites working 60.6% of aggregate work periods, while 23.1% of its 3 Native Americans employees received payment for 33.3% of work periods. The only exception being the 1 Hispanic worker, comprising 7.7% of its unique workers and taking home 2, or 6.1% of total paychecks. These disparities are further illustrated in *Figure 4: Total Weeks Worked v. Race by Contractor*.

<br>

<center>

**Table 4: Total Weeks Worked by Race & Contractor**

```{r periods_race_con_tbl, echo=FALSE, message=FALSE}
week_con_table_ft <- regulartable(week_con_table, cwidth = 3.5)
week_con_table_ft <- fontsize(week_con_table_ft, part = "all", size = 14)
theme_box(week_con_table_ft)
```

<br>

**Figure 4: Total Weeks Worked v. Race by Contractor**

```{r periods_race_con_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=7}
ggplot(week_con_table, 
       aes(x = reorder(Contractor, `Periods`), 
           y = Periods, 
           fill = Race)) +
  geom_bar(stat = "identity", 
           alpha = 0.6) +
  coord_flip() +
  xlab("Contractor") +
  ylab("Preiods (In Weeks)") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  theme(legend.position = "bottom")
```

<br>

## Titles by Race

```{r title_by_race, echo=FALSE, message=FALSE}
library(dplyr)
library(scales)
library(stringr)

titles <- master %>% 
  filter(!is.na(race)) %>% 
  select(name:rate, zip) %>% 
  unique()

lvls <- c("General Foreman", "Foreman", "Subforeman", "Operator", "Journeyman", 
          "Apprentice", "Apprentice 4th Year", "Apprentice 3rd Year", 
          "Apprentice 2nd Year", "Apprentice 1st Year", "Unspecified")

titles$title <- factor(titles$title, levels = lvls)

titles <- titles %>% 
  as_data_frame(table(titles$title)) %>%
  group_by(race, title) %>%
  summarize(`Total Workers` = n()) %>%
  rename("Race" = race, "Title" = title) %>%
  select(Title, Race, `Total Workers`) %>%
  arrange(ordered(Title), desc(`Total Workers`), Race)

title_table <- titles %>%
  ungroup %>%
  mutate(`Percent (%)` = percent(`Total Workers` / sum(`Total Workers`)))

# Aggregating Categories

titles_agg <- master %>% 
  filter(!is.na(race)) %>% 
  select(name:rate, zip) %>% 
  unique()

titles_agg$title <- str_replace_all(string = titles_agg$title, 
                                    pattern = "General Foreman|Subforeman|Foreman", 
                                    replacement = "Foreman")
titles_agg$title <- str_replace_all(string = titles_agg$title,
                                    pattern = "Apprentice.*", 
                                    replacement = "Apprentice")

lvls <- c("Foreman", "Operator", "Journeyman", "Apprentice", "Unspecified")
titles_agg$title <- factor(titles_agg$title, levels = lvls)

titles_agg <- titles_agg %>% 
  as_data_frame(table(individuals$title)) %>%
  group_by(race, title) %>%
  summarize(`Total Workers` = n()) %>%
  rename("Race" = race, 
         "Title" = title) %>%
  select(Race, Title, `Total Workers`) %>%
  arrange(reorder(Race, desc(`Total Workers`)), ordered(Title), desc(`Total Workers`))

title_agg_table <- titles_agg %>%
  ungroup() %>%
  mutate(`Total Workers (%)` = percent(`Total Workers` / sum(`Total Workers`)))

title_agg_table <- title_agg_table %>%
  group_by(Race) %>%
  mutate(`Race (%)` = percent(`Total Workers` / sum(`Total Workers`)))

```

**Notable caveats herein:** Terms"rank", "title", and "status" are used interchangeably and, although these do not reflect the modern US apprenticeship system, these ranks or titles are provided in the same fields within contractors' employment records. In other words, where one worker's record may state "Journeyman" in one field, another worker's record may state "Foreman" in the same field. Hence, "rank" or "title" is used in light of this incongruence. Lastly, titles and ranks are shown here in aggregate, having made uniform "Foreman", "Subforeman", and "General Foreman" as well as "Apprentices" for varying durations ("1st Year", "2nd Year", etc.). This has no effect on interpretation and findings. 

**Conditioning rank or title on race reveals only Whites in positions of authority.** *Table 5: Aggregate Titles by Race* breaks down ranks of all 123 unique workers by race, in descending order (i.e. from "Foreman" to "Journeyman" to "Apprentice"), per records containing racial data. All leadership positions, i.e. "General Foreman", "Foreman", and "Subforeman" are assumed by 17 White Workers (13.8%) and all 7 specialized workers assuming the "Operator" title are also White (5.7%).

**Workers of color only appear as "Journeyman" or "Apprentices".** While 56 White workers are "Journeyman" status, comprising 81.1% of all 69 "Journeymen" and 45.5% of the total workforce, African Americans, Native Americans, one Hispanic, and one worker of two or more races comprise 7, 4, 1, and 1 of all 69 "Journeyman" workers, or 10.1%, 5.7%, 1.4%, and 1.4% of all "Journeymen", respectively. In total, minority "Journeymen" comprise 18.6% of all "Journeymen" and 10.6% of the total workforce in which race is disclosed. Only 26% of 15 "Apprentices" are minorities - to wit, 2 African American workers and 2 workers of two or more races. These findings are further illustrated in *Figure 5: Aggregate Titles v. Total Workers by Race*.

<br>

<center>

**Table 5: Aggregate Titles by Race**

```{r titles_by_race_tbl, echo=FALSE, message=FALSE}
title_agg_table_ft <- regulartable(title_agg_table, cwidth = 3.5)
title_agg_table_ft <- fontsize(title_agg_table_ft, part = "all", size = 14)
theme_box(title_agg_table_ft)
```

<br>

**Figure 5: Aggregate Titles v. Total Workers by Race**

```{r titles_by_race_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=7}
ggplot(title_agg_table, 
       aes(x = factor(Title, levels=rev(levels(Title))), 
           y = `Total Workers`, 
           fill = Race)) +
  geom_bar(stat = "identity", alpha = 0.6) +
  coord_flip() +
  xlab("Title") +
  ylab("Unique Workers") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  theme(legend.position = "bottom")
```

</center>

<br>

## Titles by Race & Contractor

```{r title_by_race_con, echo=FALSE, message=FALSE}
library(dplyr)
library(scales)
library(stringr)

titles_con_agg <- master %>% 
  filter(!is.na(race)) %>% 
  select(name:rate, zip) %>% 
  unique()

titles_con_agg$title <- str_replace_all(string = titles_con_agg$title, 
                                        pattern = "General Foreman|Subforeman|Foreman", 
                                        replacement = "Foreman")
titles_con_agg$title <- str_replace_all(string = titles_con_agg$title,
                                        pattern = "Apprentice.*", 
                                        replacement = "Apprentice")

lvls <- c("Foreman", "Operator", "Journeyman", "Apprentice", "Unspecified")
titles_con_agg$title <- factor(titles_con_agg$title, levels = lvls)

titles_con_agg_table <- titles_con_agg %>% 
  as_data_frame(table(titles_con_agg$title)) %>%
  select(name, title, race) %>%
  group_by(name, race, title) %>%
  summarize(`Total Workers` = n()) %>%
  rename("Company" = name, 
         "Race" = race, 
         "Title" = title) %>%
  arrange(Company, reorder(Race, desc(`Total Workers`)), ordered(Title), desc(`Total Workers`))

titles_con_agg_table <- titles_con_agg_table %>%
  group_by(Company) %>%
  mutate(`Company (%)` = percent(`Total Workers` / sum(`Total Workers`))) %>%
  ungroup()

titles_con_agg_table <- titles_con_agg_table %>%
  group_by(Race) %>%
  mutate(`Race (%)` = percent(`Total Workers` / sum(`Total Workers`))) %>%
  ungroup()

titles_con_agg_table <- titles_con_agg_table %>%
  group_by(Title) %>%
  mutate(`Title (%)` = percent(`Total Workers` / sum(`Total Workers`))) %>%
  ungroup()
```

**Little understanding of racial disparities is added when "Title" is when broken down by contractor**, since these findings largely reflect the same absence of workers of color in leadership positions, as well as the majority of both Whites and minorities having "Journeyman" titles, as seen in *Table 6: Aggregate Titles by Race & Contractor*, below. 

**Among somewhat noteworthy findings**, *Longhouse Construction LLC* had 5 of its 7 unique workers (71.4%), all White, assuming the role of "Foreman", or variations (e.g. "Foreman +2"), while maintaining 1 African American "Journeyman" and 1 White "Apprentice". Further investigation reveals that multiple unique White workers would assume the title of "Foreman" during the same work period. During the work period ending in March 17, 2018, there were a total of 3 "Foremen" and 1 "Foreman +2", including Monday, March 13, 2018, during which all 4 worked full days. Also noteworthy is *Stone Bridge Iron & Steel, Inc.*, in which all 13 unique workers were "Journeymen" and comprised of the lowest proportion of White workers among all 5 companies, with 30.8% of unique workers comprised of 3 Native Americans (23.1%) and 1 Hispanic worker (7.7%). These findings are further illustrated in *Figure 6: Aggregate Titles v. Total Workers by Race & Contractor*.

<br>

<center>

**Table 6: Titles by Race & Contractor**

```{r title_by_race_con_tbl, echo=FALSE, message=FALSE}
titles_con_agg_table_ft <- regulartable(titles_con_agg_table, cwidth = 3.5)
titles_con_agg_table_ft <- fontsize(titles_con_agg_table_ft, part = "all", size = 14)
theme_box(titles_con_agg_table_ft)
```

<br>

**Figure 6: Titles v. Total Workers by Race & Contractor**

```{r title_by_race_con_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=7}
ggplot(titles_con_agg_table, 
       aes(x = factor(Title, levels=rev(levels(Title))), 
           y = `Total Workers`, 
           fill = Race)) +
  geom_bar(stat = "identity", alpha = 0.6) +
  coord_flip() +
  xlab("Class or Title") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  facet_wrap( ~ Company) +
  theme(legend.position = "bottom")
```

</center>

<br>

## Hourly Pay by Race

```{r rate_by_race, echo=FALSE, message=FALSE}
library(dplyr)
library(scales)

hourly <- master %>% 
  filter(!is.na(race), !is.na(rate)) %>% 
  select(name:rate, zip) %>% 
  unique() %>%
  select(name, title, race, rate) %>%
  rename("Company" = name, 
         "Title" = title, 
         "Race" = race, 
         "Hourly" = rate) %>%
  filter(Race != "Hispanic")

hourly_sum <- hourly %>%
  select(-Title) %>%
  group_by(Race) %>%
  summarize(Minimum = dollar(min(Hourly)), 
            Median = dollar(median(Hourly)),
            Average = round(mean(Hourly), digits = 2),
            Maximum = dollar(max(Hourly))) %>%
  arrange(desc(Average)) %>%
  mutate(Average = dollar(Average))

hourly_con_sum <- hourly %>%
  group_by(Company, Race) %>%
  summarize(Minimum = dollar(min(Hourly)), 
            Median = dollar(median(Hourly)),
            Average = round(mean(Hourly), digits = 2),
            Maximum = dollar(max(Hourly))) %>%
  arrange(Company, desc(Average)) %>%
  mutate(Average = dollar(Average))
```

**The reader should note certain caveats regarding wage data analyzed.** Specifically, *Patricia Electric, Inc.* was omitted from the data collection process due to its homogenous racial makeup (100% White), reducing the total number of unique workers analyzed from 123 to 110. At times, unique workers earned different hourly wages throughout the course of construction due to pay raises. Moreover, in multiple instances throughout records provided by *Quality Stuctures, Inc.*, unique workers were recorded as earning different hourly wages, atypically due to raises but, in general, due to different hourly wages among different unions. All hourly wages were made uniform across unique workers' records by selecting the lowest wage, regardless of pay period, in order to ensure the most conservative analysis possible, especially due to the findings in the present work that the majority of net pay is exported from Onondaga County. 

**Differences in minimum and maximum hourly pay between minority and White workers are significant**, as shown in *Table 7: Descriptive Statistics of Hourly Wage by Race*, a table of minimum, median, mean, and maximum hourly wages conditioned on race. While unique workers among three different categories of race - African American, White, and two or more races - tied for the lowest hourly wage, $13.73, the highest hourly wage went to White workers at $42.64, while the second highest went to Native American workers at $32.05. Those of two or more races earned the lowest maximum hourly wage, at $24.20, while African American and Hispanic workers tied for second lowest maximum hourly wage at $29. Notably, $29 per hour is both the minimum and maximum wage for "Hispanic" workers, since there was only one in the entire workforce.

**Differences in average hourly pay between minority and White workers ranged from minor to significant.** Excluding the single Hispanic worker at an average hourly wage of $29, White workers earned average hourly wages that were $2.07, $3.96, and $10.29 higher than Native American workers, African American workers, and workers of two or more races, respectively. Differences in median wages between White, African American, and Native American workers were less extreme, indicating a slightly higher skew above the average hourly wage for African American and NAtive American workers, though median is less valuable given the small number of unqiue workers among minority races.

**These differences are illustrated** in *Figure 7: Descriptive Statistics of Hourly Wage v. Race*, which depicts a box plot of hourly wage distributions conditioned on race. The center line within each box indicates median hourly wage, while the left and right bounds of each box indicates the lower and upper quartiles, or 25th and 75th percentiles, respectively. The length of the box depicts the interquartile range (IQR), or 50% of all values between the 25th and 75th percentiles, while the "whisker" length is determined by the most extreme values falling within 150% of the IQR. Outliers, which exceed these lower and upper bounds, are indicated with grey and black squares along the horizontal gridlines. Lastly, blue points overlay the box plot, each indicating the hourly wage of a unique worker. Because many hourly wages are the same, these dots are "jittered", i.e. random noise is added to each point to break up dense concentrations where multiple unique workers earned the same hourly wage. The same visualization techniques are used in *Figure 8: Descriptive Statistics of Hourly Wage v. Race by Contractor*, albeit conditioned on contractors.

<br>

<center>

**Table 7: Descriptive Statistics of Hourly Wage by Race**

```{r rate_by_race_tbl, echo=FALSE, message=FALSE}
hourly_sum_ft <- regulartable(hourly_sum, cwidth = 3.5)
hourly_sum_ft <- fontsize(hourly_sum_ft, part = "all", size = 14)
theme_box(hourly_sum_ft)
```

<br>

**Figure 7: Descriptive Statistics of Hourly Wage v. Race**

```{r rate_by_race_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=7}
set.seed(1)

ggplot(hourly, aes(x = Race, y = Hourly)) +
  geom_boxplot(alpha = 0.75, color = "lightgray", outlier.shape = 15, outlier.size = 2) +
  geom_jitter(height = 0, width = .3, color = "skyblue", alpha = 0.5, size = 2) +
  coord_flip() + 
  ylab("Hourly Pay (USD)") +
  theme_classic()
```

</center>

<br>

## Hourly Pay by Race & Contractor

**While visualization conditioned on contractor better relays disparities, most are explained by rank and experience.** Notably, the highest hourly wages are held by "Foremen"" and "Operators", particularly in *Quality Structures, Inc.*, while the lowest hourly wages in the workforce, less than $20, are earned by "Apprentices", with the notable exception of 1 Native American "Journeyman" in *Stone Bridge Iron & Steel, Inc.* earning $16.50. Otherwise, the majority of workers at *Stone Bridge* earn the same hourly rate at $29, while 1 White worker earns $30.05, and 1 Native American worker earns the highest hourly wage at $32.05. Significant hourly wage disparities at *Edward Schalk & Son, Inc.* are due to 2 White and 2 African American "Apprentices". Wages at *Schalk & Son* largely concentrate at $27.45 among the all-White "Journeymen" and "Foremen". 

<br>

<center>

**Table 8: Descriptive Statistics of Hourly Wage by Race & Contractor**

```{r rate_by_race_con_tbl, echo=FALSE, message=FALSE}
hourly_con_sum_ft <- regulartable(hourly_con_sum, cwidth = 3.5)
hourly_con_sum_ft <- fontsize(hourly_con_sum_ft, part = "all", size = 11)
theme_box(hourly_con_sum_ft)
```

<br>

**Figure 8.1: Descriptive Statistics of Hourly Wage v. Race by Contractor**

```{r rate_by_race_con_sum, echo=FALSE, message=FALSE, fig.width=12, fig.height=7}
set.seed(1)

ggplot(hourly, aes(x = Race, y = Hourly)) +
  geom_boxplot(alpha = 0.75, color = "lightgray", outlier.shape = 15, outlier.size = 3) +
  geom_jitter(alpha = 0.5, height = 0, width = .3, size = 2, color = "skyblue",
              aes(x = Race)) +
  scale_color_brewer(palette = "Set2") +
  xlab("Race") +
  ylab("Hourly Pay (USD)") +
  coord_flip() +
  theme_classic() +
  facet_wrap(~ Company) +
  theme(legend.position="none")
```

</center>

<br>

**Alternate visualizations help further illustrate these conclusions**. *Figure 8.2: Descriptive Statistics of Hourly Wage v. Title & Race by Contractor* supports the conclusion that hourly wage disparities are principally due to differences in rank or title. Moreover, the distribution of hourly wages conditioned on race and contractor is illustrated in *Figure 8.3: Frequency of Unique Hourly Wages Earned by Race & Contractor*, which depicts a stacked trellis histogram representing the frequency of pay grades for each unique worker.. Each bar represents a $1 increment in hourly rates.  

<br>

<center>

**Figure 8.2: Descriptive Statistics of Hourly Wage v. Title & Race by Contractor**

```{r rate_by_race_con_title_sum, echo=FALSE, message=FALSE, fig.width=12, fig.height=8}
hourly$Title <- str_replace_all(string = hourly$Title, 
                                pattern = "General Foreman|Subforeman|Foreman", 
                                replacement = "Foreman")
hourly$Title <- str_replace_all(string = hourly$Title,
                                pattern = "Apprentice.*", 
                                replacement = "Apprentice")

ggplot(hourly, aes(x = Race, y = Hourly)) +
  geom_boxplot(alpha = 0.75, color = "lightgray", outlier.shape = 15, outlier.size = 3) +
  geom_jitter(alpha = 0.75, height = 0, width = .3, size = 2,
              aes(color = Title)) +
  scale_color_brewer(palette = "Set2") +
  xlab("Race") +
  ylab("Hourly Pay (USD)") +
  coord_flip() +
  theme_classic() +
  facet_wrap(~ Company) +
  theme(legend.position = "bottom")
```

<br>

**Figure 8.3: Frequency of Unique Hourly Wages Earned by Race & Contractor**

```{r rate_by_race_con_title_frq, echo=FALSE, message=FALSE, fig.width=12, fig.height=8}
library(ggplot2)

ggplot(hourly, aes(x = Hourly, fill = Race)) +
  geom_histogram(binwidth = 1, alpha = 0.75) +
  xlab("Hourly Pay ($1 Increments)") +
  ylab("Number of Unique Workers") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  facet_grid(Company ~ .) +
  theme(legend.position = "bottom") +
  scale_y_continuous(minor_breaks = seq(0 , 25, 5), breaks = seq(0, 25, 5))
```

</center>

## Net Pay by Race

```{r net_race_con_tbl, echo=FALSE, message=FALSE}
library(dplyr)
library(scales)

net <- master %>% 
  filter(!is.na(race), !is.na(net)) %>% 
  unique() %>%
  select(name, title, race, net) %>%
  rename("Company" = name, "Title" = title, "Race" = race, "Net" = net)

net_sum <- net %>%
  select(-Title) %>%
  mutate(`Grand Total` = sum(Net))

net_sum <- net_sum %>%
  group_by(Race) %>%
  summarize(`Payments` = n(),
            `Total` = sum(Net)) %>%
  ungroup() %>%
  mutate(`Total Net ($)` = dollar(Total),
         `Total Net (%)` = percent(Total / sum(Total))) %>%
  arrange(desc(`Payments`))

net_sum_viz <- net_sum %>%
  select(Race:Total) %>%
  mutate(Thousands = Total / 1000)

net_sum <- net_sum %>%
  select(-Total) %>%
  bind_cols(ind_table) %>%
  select(-Race1) %>%
  rename("Workers" = `Unique Workers`,
         "Workers (%)" = Percentage)
  

net_con_sum <- net %>%
  group_by(Company, Race) %>%
  summarize(Payments = n(),
            `Total` = sum(Net)) %>%
  ungroup() %>%
  mutate(`Company Net ($)` = dollar(`Total`),
         `Workforce Net (%)` = percent(`Total` / sum(`Total`))) %>%
  arrange(reorder(Company, desc(Payments)), desc(Payments))

net_con_sum_viz <- net_con_sum %>%
  select(Company:Total)

con_table <- con_table %>%
  rename("Company" = Contractor)

net_con_sum <- net_con_sum %>%
  group_by(Company) %>%
  mutate(`Company Net (%)` = percent(Total/sum(Total))) %>%
  select(Company:Payments, `Company Net ($)`, `Company Net (%)`, `Workforce Net (%)`) %>%
  left_join(con_table, by = c("Company", "Race")) %>%
  rename("Workers" = `Unique Workers`, 
         "Workforce (%)" = Percentage)
```

### Total Net Pay by Race

**White workers earn the vast majority of all net payments**, i.e. gross earnings less deductions. According to *Table 9.1: Total Net Earnings by Race*, White workers earned total net earnings of $716.5 K (91.9%), while African American workers, Native American workers, workers of two or more races, and Hispanic workers earned $38.6 K (4.9%), $14.5 K (1.9%), $9.1 K (1.2%), and less than $1 K (0.1%), respectively.

**Minority workers earn less than Whites relative to their proportion of the workforce.** While White workers comprise 86.2% of total unique workers across contractors, they take home 91.9% of all net income. African Americans, Native Americans, workers of two or more races, and the single Hispanic worker, among records where race is disclosed, comprise 7.3%, 3.3.%, 2.4%, and 0.8% of the total workforce, but only take home 4.9%, 1.9%, 1.2%, and 0.1% of total net earnings, respectively. Recall that we see similar trends in "Section 2.4: Periods by Race" in the present work. This may be due, in part, to differences in leadership positions (i.e. "Foremen") as well as specialized classes (i.e. "Operators"), all of which are comprised of Whites. This is best illustrated in *Figure 9.1: Total Net Earnings v. Race*. 

<br>

<center>

**Table 9.1: Total Net Earnings by Race**

```{r net_by_race_tbl, echo=FALSE, message=FALSE}
net_sum_ft <- regulartable(net_sum, cwidth = 3.5)
net_sum_ft <- fontsize(net_sum_ft, part = "all", size = 12)
theme_box(net_sum_ft)
```

<br>

**Figure 9.1: Total Net Earnings v. Race**

```{r net_by_race_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=8}
library(ggplot2)
library(scales)

ggplot(net_sum_viz, aes(x = reorder(Race, Payments), 
                      y = Total)) +
  geom_bar(stat = "identity", alpha = 0.6, fill = "tomato") +
  coord_flip() +
  xlab("Race") +
  ylab("Total Earnings (USD)") +
  theme_light() +
  scale_y_continuous(name="Total Earnings (USD)", labels = scales::comma)
```

</center>

<br>

### Statistics on Net Pay by Race

```{r net_by_race_sum, echo=FALSE, message=FALSE}
net_stat <- net %>%
  filter(Race != "Hispanic") %>%
  group_by(Race) %>%
  summarize(Minimum = min(Net),
            Average = mean(Net),
            Median = median(Net),
            Maximum = max(Net)) %>%
  arrange(desc(Average)) %>%
  mutate(Minimum = dollar(Minimum),
         Average = dollar(Average),
         Median = dollar(Median),
         Maximum = dollar(Maximum))
```

**Similar to hourly wage, individual net earnings show White workers receive significantly more money.** According to *Table 9.2: Summary Statistics on Net Pay by Race*, while maximum take home pay for African Americans, Native Americans, workers of two or more races, and Hispanic workers were $1,601, $1,006, $864, and $483, respectively, while the maximum amount received by a White worker was significantly higher, at $2,478.

**The disparity between average net earnings of White and minority workers are just as extreme.** That is, on average, African Americans' net earnings per pay period are $820, Native Americans receive $659, workers of two or more races receive $608, and Hispanics earn $483 (recall, however, that there is only 1 Hispanic worker). In contrast, White workers, on average, receive $1,002 per net payment - a markedly higher sum. Median values deviate marginally from mean values, at an average absolute value of $24.05. These findings are better illustrated in *Figure 9.2: Descriptive Statistics of Net Pay v. Race*, aid in the interpretation of which is described earlier in "Section 2.8: Hourly Pay by Race". 

<br>

<center>

**Table 9.2: Summary Statistics on Net Pay by Race**

```{r net_by_race_sum_tbl, echo=FALSE, message=FALSE}
net_stat_ft <- regulartable(net_stat, cwidth = 3.5)
net_stat_ft <- fontsize(net_stat_ft, part = "all", size = 14)
theme_box(net_stat_ft)
```

<br>

**Figure 9.2: Descriptive Statistics of Net Pay v. Race**

```{r net_by_race_sum_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=7}
net_hisp_rm <- net %>%
  filter(Race != "Hispanic")

ggplot(net_hisp_rm, aes(x = Race, y = Net)) +
  geom_boxplot(alpha = 0.75, outlier.shape = 15, color = "lightgray", outlier.size = 2) +
  geom_jitter(height = .0, width = .3, color = "skyblue", alpha = 0.3, size = 2) +
  coord_flip() + 
  ylab("Hourly Pay (USD)") +
  theme_classic()
```

</center>

<br>

## Net Pay by Race & Contractor

### Total Net by Race & Contractor

**Racial disparities in net earnings relative to the proportion of workers holds true across companies**, with the exception of *Stone Bridge Iron & Steel, Inc.*. *Longhouse Construction LLC* has a crew of 85.7% White workers who take home 87% of net earnings, while its single African American worker comprises 14.3% but earns 13% of net earnings. *Edward Schalk & Son, Inc.*, with a larger crew size of 23, is comprised of 91.3% White workers receiving 94.8% of net earnings and 8.7% of African American workers receiving 5.2% of net earnings. *Quality Structures, Inc.* is comprised of 85.9% White workers receiving 92% of net earnings - and 72% of net earnings across all companies - while its African American workers, workers of two or more races, and Native American workers comprise 8.5%, 4.2%, and 1.4% of employees, but receiving 5.4%, 1.5%, and 1.1% of net earnings, respectively.

**Notably, *Stone Bridge Iron & Steel, Inc.* turns this pattern on its head.** Though there are a total of 13 unqiue workers, White, Native American, and Hispanic workers comprise 69.2%, 23.1%, and 0.8% of employees and receive 53.5%, 41.4%, and 5.1% of net earnings, respectively. These findings are revealed in *Table 10: Net Earnings by Race & Contractor* and illustrated in both *Figure 10.1: Net Earnings v. Contractor by Race* and *Figure 10.2: Individual Net Earnings v. Contractor by Race*. While the former best visualizes proportionality via stacked bars, the latter depicts the sheer outnumbering of individual net earnings comparing White workers and workers of color, as well as the significantly higher net payments many White workers receive. 

<br>

<center>

**Table 10: Net Earnings by Race & Contractor**

```{r net_by_race_con_table, echo=FALSE, message=FALSE}
net_con_sum_ft <- regulartable(net_con_sum, cwidth = 3.5)
net_con_sum_ft <- fontsize(net_con_sum_ft, part = "all", size = 12)
theme_box(net_con_sum_ft)
```

<br>

**Figure 10.1: Net Earnings v. Contractor by Race**

```{r net_by_race_con_viz, echo=FALSE, message=FALSE, fig.width=12, fig.height=8}
library(ggplot2)

ggplot(net_con_sum_viz, aes(x = reorder(Company, Total), y = Total, fill = Race)) +
  geom_bar(stat = "identity", alpha = 0.6) +
  coord_flip() +
  xlab("Contractor") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  theme(legend.position = "bottom") +
  scale_y_continuous(name="Total Earnings (USD)", labels = scales::comma)
```

<br>

**Figure 10.2: Individual Net Earnings v. Contractor by Race**

```{r net_by_race_con_scatviz, echo=FALSE, message=FALSE, fig.width=12, fig.height=8}
library(ggplot2)
set.seed(3)

ggplot(net[net$Race == "White", ], aes(x = Company, y = Net, color = Race)) +
  geom_jitter(alpha = 0.4, width = 0.175) +
  geom_jitter(data = net[net$Race != "White", ], size = 3, height = 0, width = 0.175, alpha = 0.75, 
              aes(x = Company, y = Net, color = Race)) +
  xlab("Contractor") +
  scale_color_brewer(palette = "Set2") +
  theme_classic() +
  theme(legend.position = "bottom") +
  scale_y_continuous(name="Individual Net Earnings (USD)", labels = scales::comma)
```

</center>

<br>

### Stats: Net by Race & Contractor

```{r net_race_con_sum, echo=FALSE, message=FALSE}
net_con_stat <- net %>%
  group_by(Company, Race) %>%
  summarize(Minimum = min(Net),
            Average = mean(Net),
            Median = median(Net),
            Maximum = max(Net)) %>%
  arrange(reorder(Company, desc(Average)), desc(Average)) %>%
  mutate(Minimum = dollar(Minimum),
         Average = dollar(Average),
         Median = dollar(Median),
         Maximum = dollar(Maximum))
```

**Similar racial disparities exist in net earnings by company, but only to an extreme degree in certain some.** As seen in *Table 11: Summary Statistics on Net Pay by Race & Contractor*, *Longhouse Construction LLC* exhibits relatively minor differences in average and maximum net earnings, favoring White workers, and again, Native American workers at *Stone Bridge Iron & Steel, Inc.* receive net earnings which have a moderately higher average and maximum net earnings than White workers. However, extreme disparities may be found in *Edward Schalk & Son, Inc.*, where White workers earn an average weekly net income of $1,042, the highest of which is $1,607.28. African American workers in *Edward Schalk & Son, Inc.*, in comparison, earn an average weekly net income of $692.41, the highest of which is $798 - a stark contrast to White workers.

**The most extreme racial disparities in net earnings occurs at *Quality Structures, Inc*.** The highest net payment among White workers was $2,479, while the highest net payments among African Americans, Native Americans, and workers of two or mmore races were $1,601, $819, and $864, respectively. Moreover, the average of individual net payments among White workers was $1,033, while African Americans, Native Americans, and workers of two or more races earned an average weekly net payment of $873, $610, and $608, respectively. Notably, despite also exhibiting the lowest net earning on record, $96, the median net earning of White workers was $946, $87 below average. In other words, despite the widest range in net earnings, as well as the lowest net earning on record, significantly large net payments among Whites were responsible for pulling up the average weekly net earning beyond the 50th percentile. These findings are better illustrated in the trellis boxplots conditioned on contractor in *Figure 11.1: Summary Statistics of Net Pay v. Race by Contractor*.

<br>

<center>

**Table 11: Summary Statistics on Net Pay by Race & Contractor**

```{r net_race_con_sum_tbl, echo=FALSE, message=FALSE}
net_con_stat_ft <- regulartable(net_con_stat, cwidth = 3.5)
net_con_stat_ft <- fontsize(net_con_stat_ft, part = "all", size = 14)
theme_box(net_con_stat_ft)
```

<br>

**Figure 11.1: Summary Statistics of Net Pay v. Race by Contractor**

```{r net_race_con_sum_viz, echo=FALSE, message=FALSE, fig.width=15, fig.height=10}
library(ggplot2)

ggplot(net_hisp_rm, aes(x = Race, y = Net)) +
  geom_boxplot(alpha = 0.75, color = "lightgray", outlier.shape = 15, outlier.size = 3) +
  geom_jitter(alpha = 0.3, height = 0, width = .3, size = 2, color = "skyblue") +
  scale_color_brewer(palette = "Set2") +
  xlab("Race") +
  coord_flip() +
  theme_classic() +
  facet_wrap(~ Company) +
  theme(legend.position="none") +
  scale_y_continuous(name = "Net Payments (USD)", labels = scales::comma)
```

<br>

</center>


**Alternate visualizations again help illustrate the distribution of net earnings conditioned on race and contractor.** *Figure 11.2: Frequency & Distribution of Net Pay by Race & Contractor* depicts a stacked trellis histogram depicting the frequency of weekly net payments and their distributions by race and conditioned on contractor. Each bar represents a $25 increment in net payments, while taller bars indicate higher frequency.  

<br>

<center>

**Figure 11.2: Frequency & Distribution of Net Pay by Race & Contractor**

```{r net_race_con_sum_frq, echo=FALSE, message=FALSE, fig.width=15, fig.height=10}
library(ggplot2)

ggplot(net, aes(x = Net, fill = Race)) +
  geom_histogram(binwidth = 25, alpha = 0.75) +
  xlab("Hourly Pay ($25 Increments)") +
  ylab("Number of Unique Workers") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  facet_grid(Company ~ .) +
  theme(legend.position = "bottom") +
  scale_y_continuous(minor_breaks = seq(0 , 25, 5), breaks = seq(0, 25, 5)) +
  scale_x_continuous(name = "Net Payments ($25 Increments)", labels = scales::comma)
```

</center>

<br>

# Findings: On Location

```{r geo_all, echo=FALSE, message=FALSE, eval=FALSE}
geo <- master %>% filter(!is.na(zip))
geo %>% filter(!is.na(net)) %>% nrow()
geo %>% select(name:rate, zip) %>% unique()
```

**Though the initial impetus behind analyzing employment data was driven by racial disparities**, exploratory analysis revealed another significant discovery among records. To wit, the majority of workers hired among most contractors were from neither Syracuse nor Onondaga County. In fact, a number of workers traveled to Syracuse from across the state, while some of the highest paid workers were imported from northern counties in Pennsylvania. 

**The remainder of the analysis focuses on the mass importation of workers and the exodus of wealth.** Unlike race and gender data, which were missing from a large portion of records, 1,044 of the 1,045 total records (99.9%) contained the zip code of each employee, or sufficient data to deduce the zip code, if either illegible or sporadically redacted. Zip codes were deduced by matching combinations of social security numbers, titles or positions, company names, hourly wages, and other variables to determine matches where data were missing. Among all records, 1,012 (96.8%) contained data on weekly net earnings of 188 unique workers across 7 total contractors, allowing analysts to quantify much of the disposable income exported from Syracuse, including workers in:

* John W. Danforth Company
* Edward Schalk & Son, Inc.
* Longhouse Construction LLC
* NRC NY Environmental Services, Inc.
* Patricia Electric, Inc.
* Quality Structures, Inc.
* Stone Bridge Iron & Steel, Inc.

The only contractor excluded from the financial components herein is *Niagara Erecting, Inc.*, which contained illegible, handwritten data within fields for deductions and period net earnings.

<br>

## Total Workers by County & State

```{r workers_by_county, echo=FALSE, message=FALSE}
county <- master %>%
  filter(!is.na(zip)) %>%
  select(name:rate, zip:state) %>%
  unique() %>%
  group_by(county, state) %>%
  summarize(`Total Workers` = n()) %>%
  arrange(desc(`Total Workers`)) %>%
  as_data_frame() %>%
  mutate(`Total Workers (%)` = percent(`Total Workers` / sum(`Total Workers`))) %>%
  rename("State" = state, "County" = county)
```

**Of a total workforce of 188 unique workers, just over one third reside in Onondaga County**, according to *Table 12: Total Workers by County & State*. That is, 66 unique workers, or 35.1%, reside in Onondaga County. The second and third largest proportions, comprised of 52 and 10 unique workers, or 27.7% and 5.3%, reside in Onondaga's border counties Oswego and Madison, respectively, while non-contiguous Oneida County imports 9 unique workers (4.8%). Of remaining border counties, Cayuga County and Cortland comprise the 5th and 8th largest importers, i.e. 7 and 4 unique workers, or 3.7% and 2.1%, respectively. In the entire workforce, 73 of 188 unique workers, or 38.8%, reside in counties bordering Onondaga.

**One quarter of the 188 unique workers are from outside Central New york.** That is, 49 workers across companies, or 26%, are imported from 20 counties outside Onondaga and its 4 neighboring counties, including 6 workers (3.2%) from Pennsylvania - specifically, 5 from Tioga County (2.7%) and 1 from Lycoming County (0.5%). These findings are illustrated in *Figure 12: Total Workers v. County by State*. 

<br>

<center>

**Table 12: Total Workers by County & State**

```{r workers_by_county_tbl, echo=FALSE, message=FALSE}
county_ft <- regulartable(county, cwidth = 3.5)
county_ft <- fontsize(county_ft, part = "all", size = 14)
theme_box(county_ft)
```

<br>

**Figure 12: Total Workers v. County by State**

```{r workers_by_county_viz, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.height=7}
library(ggplot2)

ggplot(county, aes(x = reorder(County, `Total Workers`), 
                   y = `Total Workers`,
                   fill = State)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  xlab("County") +
  ylab("Total Unique Workers") +
  scale_fill_brewer(palette = "Paired") +
  theme_light() +
  theme(legend.position = "bottom")
```

</center>

<br>

## Total Workers by City

```{r workers_by_city, echo=FALSE, message=FALSE}
city <- master %>%
  filter(!is.na(zip)) %>%
  select(name:rate, zip:state) %>%
  unique() %>%
  group_by(city, county, state) %>%
  summarize(`Total Workers` = n()) %>%
  arrange(desc(`Total Workers`)) %>%
  as_data_frame() %>%
  mutate(`Total Workers (%)` = percent(`Total Workers` / sum(`Total Workers`))) %>%
  rename("City" = city, "County" = county, "State" = state)

city_10 <- master %>%
  filter(!is.na(zip)) %>%
  select(name:rate, zip:state) %>%
  unique() %>%
  group_by(city, county, state) %>%
  summarize(`Total Workers` = n()) %>%
  arrange(desc(`Total Workers`)) %>%
  as_data_frame() %>%
  mutate(`Total Workers (%)` = `Total Workers` / sum(`Total Workers`)) %>%
  rename("City" = city, "County" = county, "State" = state)

city_agg <- city_10[11:81, ] %>%
  summarize(City = "Other",
            County = "Other",
            State = "Other",
            `Total Workers` = sum(`Total Workers`),
            `Total Workers (%)` = percent(sum(`Total Workers (%)`)))

city_10 <- city_10[1:10, ] %>%
  mutate(`Total Workers (%)` = percent(`Total Workers (%)`)) %>%
  bind_rows(city_agg)
```

**About one fifth of workers reside in Syracuse, while the remainder come from 80 other cities.** As seen in *Table 13: Top 10 Cities of Worker Origin*, 36 of 188 workers, or 19.1%, actually reside in Syracuse. The first and second cities exporting the most workers are Oswego, NY and Fulton, NY, totaling 18 and 17 workers, or 9.6% and 9%, respectively (35 workers, or 18.6%). The third, fourth, fifth, and sixth cities exporting the most workers include Liverpool, NY, Clay, NY, Cortland, NY, and Rochester, NY, totaling 7, 5, 4, and 4 workers, or 3.7%, 2.7%, 2.1%, and 2.1%, respectively (20 workers, or 11%). 

**More than half the total workforce reside in the 74 cities exporting 3 or less workers, each.** That is, 97 unique workers across companies, or 51.6% of the total workforce, reside outside of Syracuse, Oswego, Fulton, Liverpool, Clay, Cortland, and Rochester, NY. While some are relatively close to Syracuse, e.g. 3 workers (1.6%) residing in Baldwinsville, NY, others travel some distance to work on Hancock International's renovations, e.g. 2 workers (1.1%) residing in Mansfield, PA. These findings are illustrated in *Figure 13: Total Workers v. Top 10 Cities & All Other by County*. A full list of workers by city is available in the *Appendix* under *Table 13.1*. 

<br>

<center>

**Table 13: Top 10 Cities of Worker Origin**

```{r workers_by_city_tbl, echo=FALSE, message=FALSE}
city_10_ft <- regulartable(city_10, cwidth = 3.5)
city_10_ft <- fontsize(city_10_ft, part = "all", size = 14)
theme_box(city_10_ft)
```

<br>

**Figure 13: Total Workers v. Top 10 Cities by County**

```{r top_10_city_bar, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.height=7}
library(ggplot2)

city_10_other_rm <- city_10 %>%
  filter(City != "Other")

ggplot(city_10_other_rm, aes(x = reorder(City, `Total Workers`), 
                             y = `Total Workers`,
                             fill = County)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  xlab("City") +
  ylab("Total Unique Workers") +
  scale_fill_brewer(palette = "Set3") +
  theme_light() +
  theme(legend.position = "bottom")
```

</center>

<br>

## Race by County

```{r race_county, echo=FALSE, message=FALSE}
county_race <- master %>%
  filter(!is.na(zip),
         !is.na(race)) %>%
  select(name:rate, zip:state) %>%
  unique() %>%
  group_by(county, race) %>%
  summarize(Total = n()) %>%
  rename("Race" = race, "County" = county) %>%
  arrange(Race, desc(Total), County) %>%
  as_data_frame() %>%
  group_by(Race) %>%
  mutate(`Race (%)` = Total / sum(Total)) %>%
  as_data_frame() %>%
  mutate(`Workforce (%)` = Total / sum(Total))

race_trunc <- county_race[13:29, ] %>%
  summarize(County = "Other",
            Race = "White", 
            Total = sum(Total),
            `Race (%)` = sum(`Race (%)`),
            `Workforce (%)` = sum(`Workforce (%)`))

county_race_tbl <- county_race[1:12, ] %>%
  bind_rows(race_trunc) %>%
  mutate(`Race (%)` = percent(`Race (%)`),
         `Workforce (%)` = percent(`Workforce (%)`)) %>%
  arrange(desc(Race), desc(Total), County)

county_race_tbl <- county_race_tbl[c(1, 3:13, 2), ]

county_race <- county_race %>%
  mutate(`Race (%)` = percent(`Race (%)`),
         `Workforce (%)` = percent(`Workforce (%)`))
```

**The majority of workers of color reside in Onondaga County.** According to *Table 14: Top Counties of Worker Origin for All Races*, 88.9% of all 9 African American workers reside in Onondaga County, while 1 traveled from Oneida County. While half of the 4 Native American workers reside in Onondaga County, the remaining half traveled from Cattaraugus County. Among workers of two or more races, 2 of 3 reside in Onondaga County, while the third traveled from Cayuga County. Lastly, the single Hispanic worker also resides in Onondaga County. In total, 13 of the 17 minority workers (76.5%) originated in Onondaga County.

**Over 75% of White workers reside outside Onondaga County.** That is, only 26, or 24.1%, of White workers reside within Onondaga County, while the greatest number of White workers (34) traveled from Oswego County (31.5%). The third highest concentration of White workers (8) reside in Madison County, comprising 7.4% of Whites and 6.4% of the total workforce, while 40 White workers, comprising 37% of total White workers and 32% of the total workforce, came from counties other than Onondaga, Oswego, and Madison. These findings are illustrated in *Figure 14: Top Counties of Worker Origin for All Races*. A full list of workers by race and county is available in the *Appendix* under *Table 14.1*. 

<br>

<center>

**Table 14: Top 12 Counties of Worker Origin for All Races**

```{r race_county_tbl, echo=FALSE, message=FALSE}
county_race_tbl_ft <- regulartable(county_race_tbl, cwidth = 3.5)
county_race_tbl_ft <- fontsize(county_race_tbl_ft, part = "all", size = 14)
theme_box(county_race_tbl_ft)
```

</center>

<br>

**Note:** At first glance, there may appear to be a discrepancy between *Table 14: Top Counties of Worker Origin for All Races*. However, the above table provides counties with the greatest number of workers for all races. In other words, while only a fraction of White workers reside in Cayuga and Oneida Counties, they do not appear in the table, since Oswego, Onondaga, and Madison Counties contain the greatest number of White workers. In effect, the below visualization accounts for overlap in county origin, ensuring 7 White workers are removed from "Other" counties, while 5 and 2 are added to Cayuga and Oneida counties, respectively.

<center>

<br>

**Figure 14: Top Counties of Worker Origin for All Races**

```{r county_race_bar, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.height=7}
library(ggplot2)

county_index <- unique(county_race_tbl$County)
county_index <- which(str_detect(string = county_race$County, 
                                 pattern = "Oswego|Onondaga|Madison|Cayuga|Tioga|Cattaraugus|Oneida|Other"))

county_race_viz <- county_race[county_index, 1:3]
county_race_viz_agg <- county_race[-county_index, 1:3] %>%
  summarize(Total = sum(Total)) %>%
  mutate(County = "Other",
         Race = "White") %>%
  select(County:Race, Total)

county_race_viz <- county_race_viz %>%
  bind_rows(county_race_viz_agg)

ggplot(county_race_viz, aes(x = reorder(County, Total), 
                   y = Total,
                   fill = Race)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  xlab("County") +
  ylab("Unique Workers") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  theme(legend.position = "bottom")
```

</center>

<br>

## Race in Onondaga

```{r race_onondaga, echo=FALSE, message=FALSE}
city_race <- master %>%
  filter(!is.na(zip),
         !is.na(race),
         county == "Onondaga") %>%
  select(name:rate, zip:state) %>%
  unique() %>%
  select(race, city) %>%
  group_by(race, city) %>%
  summarize(Total = n()) %>%
  rename("Race" = race, "City" = city) %>%
  arrange(Race, desc(Total), City) %>%
  as_data_frame() %>%
  group_by(City) %>%
  mutate(`City (%)` = Total / sum(Total)) %>%
  as_data_frame() %>%
  group_by(Race) %>%
  mutate(`Race (%)` = Total / sum(Total)) %>%
  as_data_frame() %>%
  mutate(`County (%)` = Total / sum(Total))

city_race_tbl <- city_race %>%
  mutate(`Workers in Location (%)` = percent(`City (%)`),
         `Race in Location (%)` = percent(`Race (%)`),
         `Workers in County (%)` = percent(`County (%)`),
         `Total Workforce (%)` = percent(Total / sum(county_race$Total), accuracy = .1)) %>%
  select(Race:Total, `Workers in Location (%)`:`Total Workforce (%)`)
```

**The majority of Onondaga County's minority workers live in Syracuse.** Recall that there are 66 unique workers in Onondaga County, or 35.1% of the total workforce. Of those 66, 39 contain employment records disclosing race, comprising 59% of Onondaga County workers and 20.7% of the total workforce. According to *Table 15: Location of Onondaga County Workers by Race*, strictly in terms of workers residing in Onondaga County for whom race is disclosed, 100% of the 8 African American workers reside in the city of Syracuse. Among the 2 workers of two or more races, 100% also reside in Syracuse. Only 1 of 2 Native American workers live in Syracuse, the second residing in La Fayette, while the sole Hispanic worker lives in Liverpool. In sum, 11 of Onondaga County's 13 minority workers, or 84.6%, live in the city.

**Less than half of all White workers in Onondaga County live in Syracuse.** More specifically, 11 of the 26 White workers in Onondaga County, or 42.3%, live in Syracuse, comprising 50% of all workers living within the city and 28.2% of workers within the county. Of the other 15 White workers, 4 live in Liverpool, 3 live in Baldwinsville, and 2 live in Clay, comprising 15.4%, 11.5% and 7.7% of White workers in Onondaga County and 10.3%, 7.7%, and 5.6% of all Onondaga County workers, respectively. Lastly, 1 of each of the 6 remaining White worker lives in Camillus, East Syracuse, Fayetteville, Jordan, Manlius, and Tully. These findings are illustrated in *Figure 15: Location of Onondaga County Workers by Race*. 

<br>

<center>

**Table 15: Location of Onondaga County Workers by Race**

```{r race_onondaga_tbl, echo=FALSE, message=FALSE}
city_race_tbl_ft <- regulartable(city_race_tbl, cwidth = 3.5)
city_race_tbl_ft <- fontsize(city_race_tbl_ft, part = "all", size = 14)
theme_box(city_race_tbl_ft)
```

<br>

**Figure 15: Location of Onondaga County Workers by Race**

```{r race_onondaga_viz, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.height=7}
library(ggplot2)

city_race_tbl[10:15, "City"] <- "Other"

ggplot(city_race_tbl, aes(x = reorder(City, Total), 
                   y = Total,
                   fill = Race)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  xlab("City") +
  ylab("Unique Workers") +
  scale_fill_brewer(palette = "Set2") +
  theme_light() +
  theme(legend.position = "bottom")
```

</center>

<br>

## Net Wages by County

```{r net_by_county_all, echo=FALSE, message=FALSE}
county_net <- master %>%
  filter(!is.na(zip),
         !is.na(net)) %>%
  select(-pdf_no, -pdf_pg, -occur) %>%
  unique() %>%
  select(net, county, state) %>%
  group_by(state, county) %>%
  summarize(`Total Net ($)` = sum(net)) %>%
  rename("County" = county, "State" = state) %>%
  arrange(desc(`Total Net ($)`)) %>%
  as_data_frame() %>%
  mutate(`Percent (%)` = `Total Net ($)` / sum(`Total Net ($)`)) %>%
  select(2, 1, 3:4)

checks <- master %>%
  filter(!is.na(zip),
         !is.na(net)) %>%
  select(county, state, net) %>%
  group_by(county) %>%
  summarize("Total Checks" = n()) %>%
  rename("County" = county) %>%
  as_data_frame() %>%
  mutate("Checks (%)" = percent(`Total Checks` / sum(`Total Checks`))) %>%
  arrange(desc(`Total Checks`), County)

county_net_tbl <- county_net %>%
  left_join(county, by = c("County", "State")) %>%
  left_join(checks, by = "County") %>%
  mutate(`Average Net per Worker` = dollar(`Total Net ($)` / `Total Workers`),
         `Average Net per Check` = dollar(`Total Net ($)` / `Total Checks`),
         `Total Net ($)` = dollar(`Total Net ($)`),
         `Percent (%)` = percent(`Percent (%)`)) %>%
  select(1:6, 9, 7:8, 10) %>%
  rename("Workers" = `Total Workers`)

# Unformatted Numbers for Additional Calculations

checks_raw <- master %>%
  filter(!is.na(zip),
         !is.na(net)) %>%
  select(county, state, net) %>%
  group_by(county) %>%
  summarize("Total Checks" = n()) %>%
  rename("County" = county) %>%
  as_data_frame() %>%
  mutate("Checks (%)" = `Total Checks` / sum(`Total Checks`)) %>%
  arrange(desc(`Total Checks`), County)

county_net_raw <- county_net %>%
  left_join(county, by = c("County", "State")) %>%
  left_join(checks_raw, by = "County") %>%
  mutate(`Mean Net per Worker` = `Total Net ($)` / `Total Workers`,
         `Mean Net per Check` = `Total Net ($)` / `Total Checks`,
         `Total Net ($)` = `Total Net ($)`,
         `Percent (%)` = `Percent (%)`) %>%
  select(1:6, 9, 7:8, 10) %>%
  mutate(`Worker Difference` = `Mean Net per Worker` - 3302.185,
         `Check Difference` = `Mean Net per Check` - 838.2468,
         `Worker ($)` = dollar(`Worker Difference`),
         `Check ($)` = dollar(`Check Difference`),
         `Worker (%)` = percent(((`Mean Net per Worker` / 3302.185) - 1)),
         `Check (%)` = percent(((`Mean Net per Check` / 838.2468) - 1)))

net_tbl_full <- county_net_raw %>%
  mutate(`Total Net ($)` = dollar(`Total Net ($)`),
         `Percent (%)` = percent(`Percent (%)`),
         `Mean Net per Worker` = dollar(`Mean Net per Worker`),
         `Checks (%)` = percent(`Checks (%)`),
         `Mean Net per Check` = dollar(`Mean Net per Check`),
         `Worker Difference` = dollar(`Worker Difference`),
         `Check Difference` = dollar(`Check Difference`)) %>%
  rename("Total Net (%)" = `Percent (%)`,
         "Average Net/Worker ($)" = `Mean Net per Worker`,
         "Total Checks (%)" = `Checks (%)`,
         "Average Net/Check ($)" = `Mean Net per Check`,
         "Worker Difference ($)" = `Worker Difference`,
         "Check Difference ($)" = `Check Difference`,
         "Worker Difference (%)" = `Worker (%)`,
         "Check Difference (%)" = `Check (%)`) %>%
  select(County:`Average Net/Worker ($)`, `Worker Difference ($)`, `Worker Difference (%)`,
         `Total Checks`:`Average Net/Check ($)`, `Check Difference ($)`, `Check Difference (%)`)

net_tbl_workers <- net_tbl_full %>%
  select(County:`Worker Difference (%)`)

net_tbl_checks <- net_tbl_full %>%
  select(County:`Total Workers (%)`, `Total Checks`:`Check Difference (%)`)
```

**Out of more than $850,000 in net earnings, 3 of every 4 dollars left Onondaga County.** Recall that net earnings are comprised of gross earnings less deductions and liabilities, e.g. federal and taxes, union dues, family paid leave, medicare, social security, etc. In addition, recall that *Niagara Erecting, Inc.* was excluded from financial analysis for illegible data, [exhibited here](https://github.com/jamisoncrawford/REIS/blob/master/OCR%20PDFs/niagra_rocr.pdf), while *M&S Fire Protection, LLC* was excluded for failing to disclose any data beyond worker classification and net earnings, [exhibited here](https://github.com/jamisoncrawford/REIS/blob/master/OCR%20PDFs/m_and_s_fire_protection_rocr.pdf). As seen in *Table 16: Total Net Earnings by County & State*, the 66 workers in Onondaga County took home 274 paychecks (27.1% of all individual payments) and, despite representing 35.1% of the total workforce, received only 23.6% of total net earnings, or $229,352, at an average of $3,475.03 per worker and $837 per paycheck. 

**Oswego County workers received 1.8% less than Onondaga County workers in total net earnings**, despite comprising 7.4% less than the total workforce (totaling 52 workers) and receiving 15.3% fewer paychecks (232 checks). In total, workers in Oswego County received $212,446, or 21.8% of total net earnings - an average of $4,085 per worker and $915 per check, 14.9% and 8.5% more than workers in Onondaga County, respectively.

**The third largest total in net payments went to 5 workers in Tioga County, Pennsylvania.** Despite being markedly lower than Onondaga and Oswego Counties, total net earnings among 5 Tioga County, PA workers, amounted to $77,727 over 66 individual paychecks. Remarkably, the carpenters employed by *Quality Structures, Inc.*  were comprised of 4 Journeymen earning hourly rates ranging from $27.45 to $28.88, as well as a 1st-Year Apprentice, earning an hourly rate of $13.73, yet one week's maximum net pay . In total, the Tioga County workers

**Total net earnings per county is markedly lower elsewhere, but differences in average pay are staggering.** In Cortland County, 4 workers comprising 2.1% of the workforce received the third largest amount sum, $44.8 K...

**(The above interpretations require editing).**

<br>

<center>

```{r total_by_county_calc, echo=FALSE, warning=FALSE, message=FALSE}
total_earnings <- master %>%
  filter(!is.na(zip), !is.na(net)) %>%
  group_by(county, name, ssn) %>%
  mutate(total_earned = sum(net)) %>%
  ungroup() %>% 
  select(name, ssn, county, race, total_earned) %>%
  unique() %>%
  group_by(county) %>%
  mutate(med_total_in_county = median(total_earned)) %>%
  ungroup()
  
onondaga_med <- total_earnings %>%
   filter(county == "Onondaga") %>%
   summarize(med_tot = median(total_earned))

syr_total_earnings <- master %>%
  filter(!is.na(zip), !is.na(net)) %>%
  group_by(county, name, ssn) %>%
  mutate(total_earned = sum(net)) %>%
  ungroup() %>% 
  select(name, ssn, county, city, race, total_earned) %>%
  unique() %>%
  filter(city == "Syracuse") %>%
  summarize(Total = n(),
            Minimum = min(total_earned),
            Average = mean(total_earned),
            Median = median(total_earned),
            Maximum = max(total_earned)) %>%
  arrange(desc(Average)) %>%
  mutate(Minimum = dollar(Minimum),
         Average = dollar(Average),
         Median = dollar(Median),
         Maximum = dollar(Maximum))
```

**Table 16.1: Total Workforce Earnings & Average Total Worker Earnings by County**

```{r worker_net_by_county_tbl, echo=FALSE, message=FALSE}
net_tbl_workers_ft <- regulartable(net_tbl_workers, cwidth = 3.5)
net_tbl_workers_ft <- fontsize(net_tbl_workers_ft, part = "all", size = 10)
theme_box(net_tbl_workers_ft)
```

<br>

**Figure 16.1: Total Workforce Earnings by County**

```{r net_by_county_viz, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.height=7}
library(ggplot2)

ggplot(county_net_raw, aes(x = reorder(County, `Total Net ($)`), 
                   y = `Total Net ($)`,
                   fill = State)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  xlab("County") +
  ylab("Total Workforce Net Earnings (USD)") +
  scale_fill_brewer(palette = "Paired") +
  theme_light() +
  theme(legend.position = "bottom") +
  scale_y_continuous(name="Total Net Earnings in Workforce (USD)", labels = scales::comma)
```

<br>

**Table 16.2: Summary Statistics on Total Worker Earnings by County**

```{r total_by_county_sumstats, echo=FALSE, message=FALSE}

total_by_county_sumstats <- total_earnings %>%
  group_by(county) %>%
  summarize(Minimum = min(total_earned),
            Average = mean(total_earned),
            Median = median(total_earned),
            Maximum = max(total_earned)) %>%
  arrange(desc(Average)) %>%
  mutate(Minimum = dollar(Minimum),
         Average = dollar(Average),
         Median = dollar(Median),
         Maximum = dollar(Maximum)) %>%
  rename("County" = county) %>%
  left_join(county, by = "County") %>%
  select(County, `Total Workers`, `Total Workers (%)`, Minimum:Maximum) %>%
  rename("Workers" = `Total Workers`,
         "Workers (%)" = `Total Workers (%)`)

total_by_county_sumstats_ft <- regulartable(total_by_county_sumstats, cwidth = 3.5)
total_by_county_sumstats_ft <- fontsize(total_by_county_sumstats_ft, part = "all", size = 14)
theme_box(total_by_county_sumstats_ft)
```

<br>

**Figure 16.2: Distribution of Total Net Earnings per Worker by County Compared to Median Onondaga Totals**

```{r total_by_county_boxplot, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.height=7}
library(ggplot2)

ggplot(total_earnings, aes(x = reorder(county, med_total_in_county), y = total_earned)) +
  geom_hline(yintercept = 2534, color = "gray", linetype = 5) +
  geom_boxplot(alpha = 0.75, color = "lightgray", outlier.shape = 15, outlier.size = 2) +
  geom_jitter(alpha = 0.5, height = 0, width = .25, size = 1, color = "skyblue") +
  xlab("County") +
  ylab("Total Net Earnings per Worker (USD)") +
  coord_flip() +
  theme_classic() +
  scale_y_continuous(name = "Total Net Earnings per Worker (USD)", labels = scales::comma)
```

</center>

<br>

<center>

**Table 16.3: Total Workforce Earnings & Average Net Payment Size by County **

```{r check_net_by_county_tbl, echo=FALSE, message=FALSE}
net_tbl_checks_ft <- regulartable(net_tbl_checks, cwidth = 3.5)
net_tbl_checks_ft <- fontsize(net_tbl_checks_ft, part = "all", size = 10)
theme_box(net_tbl_checks_ft)
```

<br>

```{r net_payment_by_county_calc, echo=FALSE, message=FALSE, warning=FALSE}
net_payments <- master %>%
  filter(!is.na(zip), !is.na(net)) %>%
  group_by(county) %>%
  mutate(median_net = median(net)) %>%
  ungroup() %>%
  mutate(onondaga_med = 788.87)

syr_nets <- master %>%
  filter(!is.na(zip), !is.na(net), city == "Syracuse") %>%
  select(name, ssn, net, city, zip, county) %>%
  summarize(Total = n(),
            Minimum = min(net),
            Average = mean(net),
            Median = median(net),
            Maximum = max(net)) %>%
  arrange(desc(Average)) %>%
  mutate(Minimum = dollar(Minimum),
         Average = dollar(Average),
         Median = dollar(Median),
         Maximum = dollar(Maximum))
```

**Table 16.4: Summary Statistics on Net Payment Size by County**

```{r net_by_county_sumstats, echo=FALSE, message=FALSE}

net_by_county_sumstats <- net_payments %>%
  group_by(county) %>%
  summarize(Minimum = min(net),
            Average = mean(net),
            Median = median(net),
            Maximum = max(net)) %>%
  arrange(desc(Average)) %>%
  mutate(Minimum = dollar(Minimum),
         Average = dollar(Average),
         Median = dollar(Median),
         Maximum = dollar(Maximum)) %>%
  rename("County" = county) %>%
  left_join(county, by = "County") %>%
  select(County, `Total Workers`, `Total Workers (%)`, Minimum:Maximum) %>%
  rename("Workers" = `Total Workers`,
         "Workers (%)" = `Total Workers (%)`)

net_by_county_sumstats_ft <- regulartable(net_by_county_sumstats, cwidth = 3.5)
net_by_county_sumstats_ft <- fontsize(net_by_county_sumstats_ft, part = "all", size = 14)
theme_box(net_by_county_sumstats_ft)
```

<br>

**Figure 16.3: Distribution of Weekly Net Payments by County Compared to Median Onondaga Net Pay**

```{r net_by_county_boxplot, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.height=7}
library(ggplot2)
  
ggplot(net_payments, aes(x = reorder(county, median_net), y = net)) +
  geom_hline(yintercept = 788.87, color = "gray", linetype = 5) +
  geom_boxplot(alpha = 0.75, color = "lightgray", outlier.shape = 15, outlier.size = 2) +
  geom_jitter(alpha = 0.5, height = 0, width = .25, size = 1, color = "skyblue") +
  xlab("County") +
  ylab("Weekly Net Payments (USD)") +
  coord_flip() +
  theme_classic() +
  scale_y_continuous(name="Weekly Net Payments (USD)", labels = scales::comma)
```

</center>

<br>

## Net Wages by Distance

```{r distance_all, echo=FALSE, message=FALSE, warning=FALSE}
library(geosphere)

syr_long <- -76.1474
syr_lat <- 43.0481

total_by_dist <- master %>%
  filter(!is.na(zip), !is.na(net)) %>%
  group_by(county, name, ssn) %>%
  mutate(total_earned = sum(net)) %>%
  ungroup() %>% 
  select(name, ssn, title, race, net, total_earned, zip:latitude) %>%
  unique()

# Calculate Euclidean Distance Using Meeus Formula (Ellipsoidal)

total_by_dist$meeus_dist <- NA

for (i in 1:nrow(total_by_dist)){
  total_by_dist$meeus_dist[i] <- (distMeeus(p1 = c(total_by_dist$longitude[i], 
                                                   total_by_dist$latitude[i]),
                                            p2 = c(syr_long, syr_lat)) / 1000) / 1.60934
}

dist_total_cor <- cor(x = total_by_dist$meeus_dist, y = total_by_dist$total_earned)


```

<br>

**Figure 17: Total Worker Net Earnings v. Distance from Syracuse**

```{r total_by_dist_scatter, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.height=7}
ggplot(total_by_dist, aes(x = meeus_dist, y = total_earned)) +
  geom_point(alpha = 0.2) +
  geom_smooth(method = "lm", color = "tomato", alpha = 0.15) +
  xlab("Euclidean Distance from Syracuse (Miles)") +
  theme_classic() +
  scale_y_continuous(name = "Total Net Earnings (USD)", labels = scales::comma)
```

# Contributors

TBA.

<br>

# Contact

TBA.

<br>

# Appendix

<br>

## Table 13.1

<center>

**Total Workers by City, County, & State**

```{r echo=FALSE, message=FALSE}
city2 <- city %>%
  arrange(desc(`Total Workers`), State, County, City)
city_ft <- regulartable(city2, cwidth = 3.5)
city_ft <- fontsize(city_ft, part = "all", size = 14)
theme_box(city_ft)
```

</center>

## Table 14.1

<center>

**Total Workers by Race & County**

```{r echo=FALSE, message=FALSE}
county_race_ft <- regulartable(county_race, cwidth = 3.5)
county_race_ft <- fontsize(county_race_ft, part = "all", size = 14)
theme_box(county_race_ft)
```

</center>
